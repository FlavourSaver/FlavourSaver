<!DOCTYPE html>
<html>
  <head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <link href='https://fonts.googleapis.com/css?family=Chivo:900' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" type="text/css" href="stylesheets/stylesheet.css" media="screen" />
    <link rel="stylesheet" type="text/css" href="stylesheets/pygment_trac.css" media="screen" />
    <link rel="stylesheet" type="text/css" href="stylesheets/print.css" media="print" />
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <title>FlavourSaver by jamesotron</title>
  </head>

  <body>
    <div id="container">
      <div class="inner">

        <header>
          <h1>FlavourSaver</h1>
          <h2>Handlebars.js without the .js</h2>
        </header>

        <section id="downloads" class="clearfix">
          <a href="https://github.com/jamesotron/FlavourSaver/zipball/master" id="download-zip" class="button"><span>Download .zip</span></a>
          <a href="https://github.com/jamesotron/FlavourSaver/tarball/master" id="download-tar-gz" class="button"><span>Download .tar.gz</span></a>
          <a href="https://github.com/jamesotron/FlavourSaver" id="view-on-github" class="button"><span>View on GitHub</span></a>
        </section>

        <hr>

        <section id="main_content">
          <h2>WAT?</h2>

<p>FlavourSaver is a ruby-based implementation of the <a href="http://handlebars.js">Handlebars.js</a>
templating language.  FlavourSaver supports Handlebars template rendering natively
on Rails and on other frameworks (such as Sinatra) via Tilt.</p>

<p>Please use it, break it, and send issues/PR's for improvement. </p>

<h2>License</h2>

<p>FlavourSaver is Copyright (c) 2012 Sociable Limited and licensed under the terms
of the MIT Public License (see the LICENSE file included with this distribution
for more details).</p>

<h2>Installation</h2>

<p>Add this line to your application's Gemfile:</p>

<pre><code>gem 'flavour_saver'
</code></pre>

<p>And then execute:</p>

<pre><code>$ bundle
</code></pre>

<p>Or install it yourself as:</p>

<pre><code>$ gem install flavour_saver
</code></pre>

<h2>Usage</h2>

<p>FlavourSaver provides an interface to the amazing
<a href="https://github.com/rtomayko/tilt">Tilt</a> templating library, meaning that it
should work with anything that has Tilt support (Sinatra, etc) and has a 
native Rails template handler.</p>

<h2>Status</h2>

<p>FlavourSaver is in it's infancy, your pull requests are greatly appreciated.</p>

<p>Currently supported:</p>

<ul>
<li>Expressions:

<ul>
<li>with object-paths (<code>{{some.method.chain}}</code>)</li>
<li>containing object-literals (<code>{{object.['index'].method}}</code>):
Ruby's <code>:[](index)</code> method is called for literals, making FlavourSaver
compatible with <code>Hash</code> and hashlike objects.</li>
<li>with list arguments (<code>{{method arg1 "arg2"}}</code>)</li>
<li>with hash arguments (<code>{{method foo=bar bar="baz"}}</code>)</li>
<li>with list and hash arguments (<code>{{method arg1 arg2 foo=bar bar="baz"}}</code>)
provided that the hash is the last argument.</li>
<li>Comments (<code>{{! a comment}}</code>)</li>
<li>Expression output is HTML escaped</li>
</ul>
</li>
<li>Safe expressions

<ul>
<li>Expressions wrapped in triple-stashes are not HTML escaped (<code>{{{an expression}}}</code>)</li>
</ul>
</li>
<li>Block expressions

<ul>
<li>Simple API for adding block helpers.</li>
</ul>
</li>
</ul><p>Coming soon:</p>

<ul>
<li>Partials</li>
</ul><h2>Helpers</h2>

<p>FlavourSaver implements the following helpers by default:</p>

<h3>#with</h3>

<p>Yields it's argument into the context of the block contents:</p>

<pre lang="handlebars"><code>{{#with person}}
  {{name}}
{{/with}}
</code></pre>

<h3>#each</h3>

<p>Takes a single collection argument and yeilds the block's contents once 
for each member of the collection:</p>

<pre lang="handlebars"><code>{{#each people}}
  {{name}}
{{/each}}
</code></pre>

<h3>#if</h3>

<p>Takes a single argument and yields the contents of the block if that argument
is truthy.</p>

<pre lang="handlebars"><code>{{#if person}}
  Hi {{person.name}}!
{{/if}}
</code></pre>

<p>It can also handle a special case <code>{{else}}</code> expression:</p>

<pre lang="handlebars"><code>{{#if person}}
  Hi {{person.name}}!
{{else}}
  Nobody to say hi to.
{{/if}}
</code></pre>

<h3>#unless</h3>

<p>Exactly the same is <code>#if</code> but backwards.</p>

<h3>this</h3>

<p>In JavaScript this is a native keyword, in Ruby not-so-much. FlavourSaver's <code>this</code> helper
returns <code>self</code>:</p>

<pre lang="handlebars"><code>{{#each names}}
  {{this}}
{{/each}}
</code></pre>

<h3>Adding additional helpers</h3>

<p>Additional helpers can easy be added by calling <code>FS.register_helper</code>, eg:</p>

<div class="highlight"><pre><span class="no">FS</span><span class="o">.</span><span class="n">register_helper</span><span class="p">(</span><span class="ss">:people</span><span class="p">)</span> <span class="k">do</span>
  <span class="o">[</span>
    <span class="p">{</span> <span class="n">firstName</span><span class="p">:</span> <span class="s1">'Yehuda'</span><span class="p">,</span> <span class="n">lastName</span><span class="p">:</span> <span class="s1">'Katz'</span> <span class="p">},</span>
    <span class="p">{</span> <span class="n">firstName</span><span class="p">:</span> <span class="s1">'Carl'</span><span class="p">,</span> <span class="n">lastName</span><span class="p">:</span> <span class="s1">'Lerche'</span> <span class="p">},</span>
    <span class="p">{</span> <span class="n">firstName</span><span class="p">:</span> <span class="s1">'Alan'</span><span class="p">,</span> <span class="n">lastName</span><span class="p">:</span> <span class="s1">'Johnson'</span> <span class="p">},</span>
  <span class="o">]</span>
<span class="k">end</span>
</pre></div>

<p>Block helpers can simply yield from the blocks body:</p>

<div class="highlight"><pre><span class="no">FS</span><span class="o">.</span><span class="n">register_helper</span><span class="p">(</span><span class="ss">:list</span><span class="p">)</span> <span class="k">do</span> <span class="o">|</span><span class="n">people</span><span class="o">|</span>
  <span class="s2">"&lt;ul&gt;</span><span class="se">\n</span><span class="s2">  &lt;li&gt;</span><span class="si">#{</span><span class="n">people</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="s2">"&lt;/li&gt;</span><span class="se">\n</span><span class="s2">  &lt;li&gt;"</span><span class="p">)</span><span class="si">}</span><span class="s2">&lt;/li&gt;</span><span class="se">\n</span><span class="s2">&lt;/ul&gt;"</span>
<span class="k">end</span>
</pre></div>

<p>So rendering the following template:</p>

<pre lang="handlebars"><code>{{#list people}}{{firstName}} {{lastName}}{{/list}}
</code></pre>

<p>Would output:</p>

<div class="highlight"><pre><span class="nt">&lt;ul&gt;</span>
  <span class="nt">&lt;li&gt;</span>Yehuda Katz<span class="nt">&lt;/li&gt;</span>
  <span class="nt">&lt;li&gt;</span>Carl Lerge<span class="nt">&lt;/li&gt;</span>
  <span class="nt">&lt;li&gt;</span>Alan Johnson<span class="nt">&lt;/li&gt;</span>
<span class="nt">&lt;/ul&gt;</span>
</pre></div>

<h3>Adding block helpers</h3>

<p>Creating a block helper works exactly like adding a regular helper, except that
the helper implementation can call <code>yield.contents</code> one or more times, with an
optional argument setting the context of the block execution:</p>

<div class="highlight"><pre><span class="no">FW</span><span class="o">.</span><span class="n">register_helper</span><span class="p">(</span><span class="ss">:three_times</span><span class="p">)</span> <span class="k">do</span>
  <span class="k">yield</span><span class="o">.</span><span class="n">contents</span>
  <span class="k">yield</span><span class="o">.</span><span class="n">contents</span>
  <span class="k">yield</span><span class="o">.</span><span class="n">contents</span>
<span class="k">end</span>
</pre></div>

<p>Which when called with the following template:</p>

<pre lang="handlebars"><code>{{#three_times}}
  hello
{{/three_times}}
</code></pre>

<p>would result in the following output:</p>

<pre><code>  hello
  hello
  hello
</code></pre>

<p>Implementing a simple iterator is dead easy:</p>

<div class="highlight"><pre><span class="no">FW</span><span class="o">.</span><span class="n">register_helper</span><span class="p">(</span><span class="ss">:list_people</span><span class="p">)</span> <span class="k">do</span> <span class="o">|</span><span class="n">people</span><span class="o">|</span>
  <span class="n">people</span><span class="o">.</span><span class="n">each</span> <span class="k">do</span> <span class="o">|</span><span class="n">person</span><span class="o">|</span>
    <span class="k">yield</span><span class="o">.</span><span class="n">contents</span> <span class="n">person</span>
  <span class="k">end</span>
<span class="k">end</span>
</pre></div>

<p>Which could be used like so:</p>

<pre lang="handlebars"><code>{{#list_people people}}
  &lt;b&gt;{{name}}&lt;b&gt;&lt;br /&gt;
  Age: {{age}}&lt;br /&gt;
  Sex: {{sex}}&lt;br /&gt;
{{/list_people}}
</code></pre>

<p>Block helpers can also contain an <code>{{else}}</code> statement, which, when used creates
a second set of block contents (called <code>inverse</code>) which can be yielded to the output:</p>

<div class="highlight"><pre><span class="no">FW</span><span class="o">.</span><span class="n">register_helper</span><span class="p">(</span><span class="ss">:isFemale</span><span class="p">)</span> <span class="k">do</span> <span class="o">|</span><span class="n">person</span><span class="p">,</span><span class="o">&amp;</span><span class="n">block</span><span class="o">|</span>
  <span class="k">if</span> <span class="n">person</span><span class="o">.</span><span class="n">sex</span> <span class="o">==</span> <span class="s1">'female'</span>
    <span class="n">block</span><span class="o">.</span><span class="n">call</span><span class="o">.</span><span class="n">contents</span>
  <span class="k">else</span>
    <span class="n">block</span><span class="o">.</span><span class="n">call</span><span class="o">.</span><span class="n">inverse</span>
  <span class="k">end</span>
<span class="k">end</span>
</pre></div>

<p>You can also register an existing method:</p>

<div class="highlight"><pre><span class="k">def</span> <span class="nf">isFemale</span><span class="p">(</span><span class="n">person</span><span class="p">)</span>
  <span class="k">if</span> <span class="n">person</span><span class="o">.</span><span class="n">sex</span> <span class="o">==</span> <span class="s1">'female'</span>
    <span class="k">yield</span><span class="o">.</span><span class="n">contents</span>
  <span class="k">else</span>
    <span class="k">yield</span><span class="o">.</span><span class="n">inverse</span>
  <span class="k">end</span>
<span class="k">end</span>

<span class="no">FW</span><span class="o">.</span><span class="n">register_helper</span><span class="p">(</span><span class="nb">method</span><span class="p">(</span><span class="ss">:isFemale</span><span class="p">))</span>
</pre></div>

<p>Which could be used like so:</p>

<pre lang="handlebars"><code>{{#isFemale person}}
  {{person.name}} is female.
{{else}}
  {{person.name}} is male.
{{/isFemale}}
</code></pre>

<h2>Using with Rails</h2>

<p>One potential gotcha of using FlavourSaver with Rails is that FlavourSaver doesn't let you
have any access to the controller's instance variables. This is done to maintain compatibility
with the original JavaScript implementation of Handlebars so that templates can be used on
both the server and client side without any change.</p>

<p>When accessing controller isntance variables you should access them by way of a helper method
or a presenter object.</p>

<p>For example, in <code>ApplicationController.rb</code> you may have a <code>before_filter</code> which authenticates
the current user's session cookie and stores it in the controller's <code>@current_user</code> instance
variable.</p>

<p>To access this variable you could create a simple helper method in <code>ApplicationHelpers</code>:</p>

<div class="highlight"><pre><span class="k">def</span> <span class="nf">current_user</span>
  <span class="vi">@current_user</span>
<span class="k">end</span>
</pre></div>

<p>Which would mean that you are able to access it in your template:</p>

<pre lang="handlebars"><code>{{#if current_user}}
  Welcome back, {{current_user.first_name}}!
{{/if}}
</code></pre>

<h2>Contributing</h2>

<ol>
<li>Fork it</li>
<li>Create your feature branch (<code>git checkout -b my-new-feature</code>)</li>
<li>Commit your changes (<code>git commit -am 'Added some feature'</code>)</li>
<li>Push to the branch (<code>git push origin my-new-feature</code>)</li>
<li>Create new Pull Request</li>
</ol>
        </section>

        <footer>
          FlavourSaver is maintained by <a href="https://github.com/jamesotron">jamesotron</a><br>
          This page was generated by <a href="http://pages.github.com">GitHub Pages</a>. Tactile theme by <a href="http://twitter.com/jasonlong">Jason Long</a>.
        </footer>

        
      </div>
    </div>
  </body>
</html>